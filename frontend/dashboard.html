<script>
    const API_BASE_URL = 'http://localhost:5000/api';
    let currentUser = null;
    let services = [];
    
    // Check authentication
    async function checkAuth() {
        try {
            const response = await fetch(`${API_BASE_URL}/auth/check`, {
                credentials: 'include'
            });
            
            if (!response.ok) {
                window.location.href = 'index.html';
                return;
            }
            
            const data = await response.json();
            currentUser = data.user;
            document.getElementById('userName').textContent = currentUser.name || currentUser.username;
            
            // Load data
            loadDashboardData();
            loadServices();
        } catch (error) {
            console.error('Auth check error:', error);
            window.location.href = 'index.html';
        }
    }
    
    // Rest of dashboard JavaScript remains the same...
</script>